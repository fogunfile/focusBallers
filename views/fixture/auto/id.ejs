<%- include("../../partials/header") -%>
    <header class="jumbotron">
        <h1>Fixtures</h1>
        <div class="d-flex justify-content-start">
            <a href="/" class="mr-2">Standings</a>
            <a href="/result/" class="mx-2">Results</a>
        </div>
    </header>
    <div class="container fixtures">

        <aside class="mb-5 justify-content-center">
            <% if(matchWeeks){ %>
                <div class="position-absolute mt-2">
                    <select name="matchWeek" id="matchWeek" class="h2 form-control">
                        <option value="<%= thisMatchWeek._id%>">Matchweek <%= thisMatchWeek.order %></option>
                        <% matchWeeks.forEach((matchWeek)=>{ %>
                            <option value="<%= matchWeek._id%>">Matchweek <%= matchWeek.order %></option>
                        <% }) %>
                    </select>
                </div>
            <% } %>
            <div class="text-center">
                <h2>Matchweek <span id="matchWeekOrder"><%= thisMatchWeek.order %></span></h2> 
                <p id="matchWeekDate">(<%= moment(thisMatchWeek.start).format("DD-MM-YYYY") %> to <%= moment(thisMatchWeek.end).format("DD-MM-YYYY") %>)</p>
            </div>
        </aside>
        <main>
            <ol class="container">
                <% results.forEach((result, i)=> { %>
                    <% let url; %>
                    <% let homeTeamName; %>
                    <% let awayTeamName; %>
                    <% let homeTeamScore; %>
                    <% let awayTeamScore; %>
                    <% let medianValue; %>
                    <% if(result){ %>
                        <% url = `/result/${result._id}` %>
                        <% homeTeamName = result.fixture.homeTeam.name %>
                        <% awayTeamName = result.fixture.awayTeam.name %>
                        <% homeTeamScore = result.homeTeamScore %>
                        <% awayTeamScore = result.awayTeamScore %>
                        <% medianValue = '-' %>
                    <% } else { %>
                        <% result = fixtures[i]; %>
                        <% homeTeamName = result.homeTeam.name %>
                        <% awayTeamName = result.awayTeam.name %>
                        <% url = `/result/${result._id}/check` %>
                        <% medianValue = 'vs' %>
                    <% } %>
                    <div class="h6 container justify-content-center">
                        <a href="<%= url %>" class="d-flex justify-content-center" id="url<%= i %>">
                            <div class="col-md-4 text-right d-flex justify-content-end">
                                <span class="d-flex align-items-center" id="homeTeamName<%=i%>"><%= homeTeamName %></span>
                                <h4 class="d-flex align-items-center text-right ml-2" id="homeTeamScore<%=i%>"><%= homeTeamScore %></h4>
                            </div>
                            <div class="d-flex align-items-center" id="medianValue<%= i %>">
                                <%= medianValue %>
                            </div>
                            <div class="col-md-4 text-left d-flex justify-content-start">
                                <h4 class="d-flex align-items-center text-left mr-2" id="awayTeamScore<%=i%>"><%= awayTeamScore %></h4>
                                <span class="d-flex align-items-center" id="awayTeamName<%=i%>"><%= awayTeamName %></span>
                            </div>
                        </a>
                    </div>
                    <hr>
                <% }) %> 
            </ol>
            <div class="d-flex justify-content-center my-5">
                <div class="mx-2">
                    <a href="/fixture/auto/<%= thisMatchWeek._id %>/" class="btn btn-warning" id="thisMatchWeekLink">Delete Matchweek <span class="thisMatchWeekOrder"><%= thisMatchWeek.order %></span> fixtures</a>
                </div>
                <div class="mx-2">
                    <a href="/fixture/auto/<%= thisMatchWeek._id %>/edit" class="btn btn-primary" id="thisMatchWeekEditLink">Edit Matchweek <span class="thisMatchWeekOrder"><%= thisMatchWeek.order %></span></a>
                </div>
                <div class="mx-2">
                    <a href="/fixture/auto" class="btn btn-success">Generate fixtures</a>
                </div>
            </div>
        </main>
    </div>

<%- include("../../partials/footer") -%>
